<!DOCTYPE html>

<html lang="ko">
    <head>
        <meta charset="UTF-8" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css" />
        <!-- JS -->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" crossorigin="anonymous"></script>

        <title>로그인 페이지</title>

        <!-- style -->
        <style type="text/css">
            * {
                font-family: 'Stylish', sans-serif;
            }

            .wrap {
                width: 500px;
                margin: auto;
            }

            .titlegram {
                width: 500px;
                height: 200px;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            #register-box {
                width: 800px;
                margin: auto;
                padding: 5px;

                border-radius: 5px;
            }
        </style>

        <script>
            function openRegister() {
                event.preventDefault();
                $('#register-box').show();
            }

            function signup() {
                $.ajax({
                    type: 'POST',
                    url: '/users/register',
                    data: {
                        id_give: $('#register-id').val(),
                        pw_give: $('#register-password').val(),
                    },
                    success: function (response) {
                        if (response.result === 'success') {
                            alert('회원가입이 완료되었습니다.');
                            console.log(response._id);
                        } else {
                            alert('ID 중복 미확인');
                        }
                    },
                    error: function () {
                        alert('서버 오류!');
                    },
                });
            }

            function checkId() {
                $.ajax({
                    type: 'GET',
                    url: '/users/check_id',
                    data: { id_give: $('#register-id').val() },
                    success: function (response) {
                        if (response.result === 'success') {
                            alert('사용 가능한 ID입니다.');
                        } else {
                            alert('이미 사용 중인 ID입니다.');
                        }
                    },
                    error: function () {
                        alert('서버 오류!');
                    },
                });
            }

            function login() {
                $.ajax({
                    type: 'GET',
                    url: '/users/login',
                    data: { id: $('#login-id').val(), pw: $('#login-password').val() },
                    success: function (response) {
                        if (response.result === 'success') {
                            alert(response.message);
                        } else {
                            alert('ID 없다');
                        }
                    },
                    error: function () {
                        alert('서버 오류!');
                    },
                });
            }
        </script>
    </head>

    <body>
        <div class="wrap">
            <div class="titlegram">
                <p style="font-weight: bold; font-size: 5em; text-align: center">정글 그램</p>
            </div>

            <!-- 계정 입력부분 (로그인) -->

            <!-- id/pw 입력 -->

            <div class="field" style="margin-bottom: 50px">
                <div class="control">
                    <input id="login-id" class="input" placeholder="아이디을 입력하세요" />
                </div>
            </div>

            <div class="field" style="margin-bottom: 50px">
                <div class="control">
                    <input id="login-password" class="input" type="password" placeholder="비밀번호를 입력하세요" />
                </div>
            </div>

            <div class="field is-grouped">
                <div class="control">
                    <button onclick="login()" class="button is-link">로그인</button>
                </div>
                <div class="control">
                    <button class="button is-text" onclick="openRegister(event)">회원가입</button>
                </div>
            </div>
        </div>

        <!-- 회원가입란 -->
        <div id="register-box" style="display: none">
            <hr class="mt-5 mb-5" />
            <div class="box">
                <h2 class="title is-4 has-text-centered mb-5">회원가입</h2>

                <!-- 아이디 -->
                <div class="field is-horizontal">
                    <label class="label field-label is-normal">아이디</label>
                    <div class="field-body">
                        <div class="field is-grouped">
                            <div class="control is-expanded has-icons-left has-icons-right">
                                <input id="register-id" class="input" placeholder="아이디를 입력하세요" />
                                <span class="icon is-small is-left">
                                    <i class="fas fa-envelope"></i>
                                </span>
                            </div>
                            <div class="control">
                                <button onclick="checkId()" class="button is-info is-outlined" id="check-id-button">중복확인</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 비밀번호 -->
                <div class="field is-horizontal">
                    <label class="label field-label is-normal">비밀번호</label>
                    <div class="field-body">
                        <div class="control has-icons-left">
                            <input id="register-password" class="input" type="password" placeholder="비밀번호를 입력하세요" />
                            <span class="icon is-small is-left">
                                <i class="fas fa-lock"></i>
                            </span>
                        </div>
                    </div>
                </div>

                <!-- 가입버튼 -->
                <div class="field">
                    <div class="control">
                        <button onclick="signup()" class="button is-primary is-fullwidth" id="register-button">가입</button>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
